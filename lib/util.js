// Generated by CoffeeScript 1.4.0
var RangeImplementation, doc, svgClose, svgOpen;

RangeImplementation = require('./Range-shim');

doc = document;

module.exports = {
  createRange: function() {
    return new RangeImplementation;
  },
  rmChild: function(el, index) {
    var child;
    if (child = el.childNodes[index]) {
      el.removeChild(child);
    }
  },
  move: function(el, from, toIndex, howMany) {
    var before, child, childNodes, frag, next;
    if (howMany == null) {
      howMany = 1;
    }
    childNodes = el.childNodes;
    child = childNodes[from];
    before = childNodes[toIndex] || null;
    if (howMany === 1) {
      el.insertBefore(child, before);
    } else {
      frag = doc.createDocumentFragment();
      while (howMany--) {
        next = child.nextSibling;
        frag.appendChild(child);
        child = next;
      }
      el.insertBefore(frag, before);
    }
  },
  createFragment: function(rangeOrParent, html) {
    var child, fragment, isSVG, range, svgWrap, tagName;
    if (tagName = rangeOrParent.tagName) {
      range = this.createRange();
      range.setStartAfter(rangeOrParent);
      if (tagName === 'svg') {
        isSVG = true;
        html = svgOpen + html + svgClose;
      }
    } else {
      range = rangeOrParent;
    }
    fragment = range.createContextualFragment(html);
    if (isSVG) {
      svgWrap = fragment.firstChild;
      while (child = svgWrap.firstChild) {
        fragment.insertBefore(child, svgWrap);
      }
      fragment.removeChild(svgWrap);
    }
    return fragment;
  }
};

svgOpen = '<svg xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink>';

svgClose = '</svg>';
